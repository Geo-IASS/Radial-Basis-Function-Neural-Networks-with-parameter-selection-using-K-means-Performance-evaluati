/*
 ============================================================================
 Name        : RBF_NN.c
 Author      : Luis Neto
 Version     :
 Copyright   : Free
 Description : Hello World in C, Ansi-style
 ============================================================================
 */

#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include "rbf_train.h"
#include "rbfn_test.h"

int main(void) {

	double F[2][200] = {{14.2812126008021,2.40159844283405,8.93868556371693,-1.41349379269777,13.2862020001015,15.4736007356896,
			21.1610953413330,1.17569940420079,10.1808933480510,16.0256379956665,15.7560680660924,-4.23024482565053,
			1.38830470861511,11.7124988004823,10.3655040277884,16.4019430458232,16.1996426046242,6.24321620551454,
			4.66017491346891,12.9008926659443,-2.78916915701110,-0.756054378244100,-5.11196118484937,2.20137884557175,
			2.56052567382385,-6.89676542323949,16.9585948256941,7.43244731794973,15.2030572200700,8.90800406229988,
			4.17174572086254,10.4577618073521,8.54899194371996,6.36901603622153,-2.22361127484292,-2.25295207906127,
			3.67652511802386,17.0951274028006,15.3125543556959,1.77491934976391,18.1068477823939,-3.50440874557498,
			14.4658940713766,2.04438995046360,-1.60687042525224,14.1101133947980,13.5040924684253,0.209318423059555,
			5.56602519165412,22.3267394415062,21.9362430671734,16.5961087073308,13.0917063402666,17.9105270658057,
			25.5869563730117,14.0340259721146,18.8916827428130,11.2847066017868,18.2345492934739,17.1898644557065,
			15.8268187509705,15.5937193803509,14.2069514764214,18.0877868459761,6.54301538275782,0.0188011022187821,
			19.2881642384613,14.0097522664785,5.51110277891804,-0.848914041657108,15.3609098585540,21.1321676454050,
			2.31610490206531,15.2656962218167,16.7082047858784,1.48996441449627,16.6807935665354,3.38938561218701,
			-0.356782124779695,7.61483964093167,3.00869534709351,2.36106782557520,13.6435547144367,23.6989729196135,
			2.02176597354818,-2.93815034404762,3.57837059652456,5.76901592894034,3.13665603700320,18.3581778932840,
			0.0245225071874487,18.0778901110523,19.0421898696030,16.4149107797853,14.0101022798430,-6.32570777713501,
			12.5496103903366,13.6528976999075,2.18550727498315,-0.596227930401045,-2.25652002190167,11.4805982813918,
			11.1108071334261,0.595551519378463,7.41790152705420,0.620557574455676,18.1753802147118,3.59251822931513,
			0.607127358179839,15.5600901367071,14.9783779726924,10.6567674880010,0.572562661650971,9.52881503648163,
			18.4425483190618,-1.11028309510234,22.6552074265780,1.52857176091955,11.7967082387186,16.2856512346812,
			2.69701749517677,17.1094605628351,14.9471601578906,17.7696218193887,-0.106744829877027,23.9683813342964,
			16.3623480475518,-0.697768674759603,-1.83283957492914,16.5671568434539,14.7788909191327,13.3463806208399,
			1.05293605975148,19.5032895638899,19.2391292308866,6.51765210137026,-0.150363547132482,6.57118746533967,
			2.90296323932728,24.6314175585052,-3.35588207295589,12.6195926297959,14.6737995017974,-1.24246980846133,
			14.0939018345120,-3.31114372523274,14.5683793822739,9.12910426325473,-1.45018674121576,5.40455417255765,
			11.7777451862471,21.8989259529655,-2.53590885886144,2.34727465310846,12.8347646743986,6.28733322598527,
			14.9723676095752,12.8652479432592,-1.56825529709172,19.0611999295986,18.3253822101105,16.9283564738441,
			-0.945220710299680,19.5136067480126,-5.62256763125119,-1.63380555530297,18.8049508313337,0.645733463505466,
			14.7458746789992,0.839296988196144,-1.93662636566524,0.225871822863945,0.862182176118541,-5.41490482196438,
			2.01450747187285,4.21778254612465,2.37563071217741,1.53775290314330,-3.89995040296742,9.33986018875256,
			0.692761975705697,-0.292211652269183,15.6484887586039,1.60910427378523,-0.436545483538561,4.99648930101395,
			11.8524377794094,13.9853861365866,16.6181573461363,15.0585317719950,-7.08813784557944,15.6537695636645,
			12.0168962630985,1.67723567435674,25.6447651985128,13.3891179963658,-0.874498151497288,11.3524553882347,
			20.0976366073909,10.98746749494520},
			{11.8805573368004,3.59549345710772,11.9479071655813,2.72158356707532,5.37891084960770,4.53916027695497,
					13.3136852809598,1.42968177019754,3.50706482049206,5.32506478868805,13.1782979928824,5.06468233446508,
					3.69539603416900,10.8375378859918,7.11171088653051,6.55096824674042,-2.81808228439783,5.38040446059586,
					3.64540824396504,9.20420741435247,1.93564475743872,5.40901781932413,-1.08737601411223,9.26836671359533,
					4.59510806502885,15.7363922502861,13.1865516938475,7.67906945778020,7.18997553451822,9.95310379981876,
					5.22252477847578,7.16710624779285,7.31292636498547,5.98462362402194,5.81929887826745,-1.73718039980656,
					10.4094014158522,13.7368600964481,10.9610795926084,2.36610580985506,11.5304433847690,6.84530342132852,
					5.42559223733318,7.19006844651238,3.59333148683088,11.3160692143971,6.68787928179125,13.1882177750107,
					10.9228119149250,10.6285161617420,12.4439913558402,12.0355381003184,3.14807946531659,10.0590687327564,
					12.1682079965361,6.72811376322668,10.7024228407599,-0.788404506305724,8.44531403443019,3.19337930145754,
					10.6608395762049,4.19888015785614,1.48110039900245,6.91136637306372,12.3857049036165,5.34920254111777,
					9.81493509711547,9.02631748845986,3.40811095453455,9.74493610973943,0.629060160555664,7.55535179915942,
					2.71146931750863,10.9659725698916,8.17799219774800,-1.60372139665034,12.1779756168055,6.76366740471856,
					7.18064262342038,8.71813122214504,9.01694434962240,6.18311760952148,10.9430952609291,8.62629734699830,
					8.32248032126810,2.66337449482333,4.76215838111971,3.40578306272497,5.91248046904685,8.52803787280151,
					-1.34142149460728,3.83820579634780,11.7915724989288,11.3786669786626,11.4442282885855,5.64715581892942,
					9.42217238411746,12.0299387365047,2.58997488237464,10.3081588287490,4.38572384631494,10.8715948012637,
					7.47710189459018,11.5341914760909,2.63837647029685,6.68323804370735,7.63349546234560,-2.02891514362651,
					3.10337532329526,11.0471447954924,6.05580213914000,9.26340230640253,7.10056024660532,2.02366187763221,
					7.51003703887285,3.28350038250160,8.99208828975962,-2.36783178286626,4.41694371675408,7.85296454001800,
					11.4634832250896,10.5683599209455,8.41512070537660,10.4560684438718,-0.827219746057295,8.56175907020117,
					10.9931691062273,9.12313438387317,1.03418107997548,7.15607599372160,7.79907517753362,10.2343247014646,
					6.59383625936567,13.5161290604121,11.6634543453315,11.0882416909681,12.2890963356184,6.86933817926475,
					6.03620865395138,7.11899708304531,4.76704607587292,2.73704552115116,11.1777650838573,5.10154858906015,
					7.72556381754845,4.69654128650971,6.84357442786855,-1.57312075782710,12.1056465747309,8.45779876809342,
					3.79718649372331,2.63430550246417,5.82870288702979,2.95731975889694,7.62564397619931,4.18545784709711,
					6.25270556774133,8.25292950045579,-1.67462126771284,11.5485278080847,14.9692332918124,8.81948085281682,
					4.39560566753278,12.8429400813782,-4.98773711807044,4.08788380107636,16.0423573234522,7.72656575752114,
					10.2467046470755,7.75692841640211,0.0274428291562225,9.23487642471644,3.95982672299086,2.05365197021819,
					4.81944441647553,6.70923561918052,7.28195208549396,11.6709739962383,5.53213103051065,9.58564571425543,
					6.61572309345015,5.17991692764239,11.8808332771129,4.47046384545325,6.84750177991413,6.26283316011381,
					5.56906282469468,5.63280665265148,0.873173496801507,2.84567158198811,-6.21664744094418,9.27104691175806,
					5.16136483833888,3.24255342364762,13.3788443944322,10.1617145448770,9.06278028932820,1.85428302422111,
					10.6926585840671,8.77647179319023}};

	double Fs[2][200] = {
			{
					3.11147826117040,21.2737583455189,1.91415763420629,-1.73936874898727,-1.14704359742669,20.6396338570676,17.0390290954043,
					-2.55222409836411,18.8496003415388,6.57773076241394,-0.835233696219044,10.5702628151614,3.02997031189773,12.4714782605939,
					15.9544948726946,6.91279003317639,16.1220768009585,-3.74786200147826,-1.41221044151731,1.59686086351603,2.12053463036040,
					-3.65093097496938,3.61930666398554,18.6222123507446,2.77438375114138,-9.09081844326860,24.3433517840955,16.9165099737916,
					11.2129700492388,2.45123275960252,8.66607453544988,17.4007680139821,14.0163596614534,-1.14775209024638,1.68082292552539,
					14.4369728291018,-3.89456025720447,5.17929696890558,17.5697938611640,16.0942310410151,10.4899397810855,13.5428398071072,
					0.140289790090086,4.96625197865191,1.11309665399642,0.675214711194924,-0.195706796319075,8.45952819160497,2.09340338252959,
					14.8435364261943,-6.63672605447839,16.7459935051071,5.19426640522441,-0.978981099363023,-0.591061719026221,10.1324323492831,
					9.02090254050675,-0.918389932657373,-1.24431371599004,11.6911035908922,0.752935117116298,10.7574762628432,13.1453631885420,
					4.11478651263410,15.3008095019622,10.5747069150519,-0.426717310120699,-8.81143038444230,18.7268918302180,13.9812020146127,
					11.5572704099089,-0.996741790152431,11.9255262777083,-2.44197422167812,13.3020068942735,-3.06065792680881,14.8195485101728,
					10.2910371302725,-1.40305465960097,8.74546569474799,5.19709328948693,-0.0336819089433507,2.65872889115118,9.43685064045707,
					15.6876425967223,-1.34732559627100,14.1435072922573,0.130473914494847,19.9378776940335,16.3689177173788,19.1911274404636,
					14.4131590633419,15.3456713063131,-4.67093121674495,-3.82819117953133,0.856986906226407,-1.62798765726338,-3.40732184112078,
					14.3993027023213,15.9317431127029,18.7761125000333,2.77488172498746,7.04086175360273,10.6425876033507,-8.75232404656706,
					-8.35205276758340,3.49146131486351,8.23272303354398,4.37675282455042,15.3012966573034,-0.896584778938472,8.98989517088438,
					-6.80008749242847,10.2739760483767,0.236799217380344,17.7002181548075,0.341165793544565,17.4223410878074,-5.79754187910490,
					15.2680949600792,15.8499398229519,-1.17643619775848,0.157464556381306,14.5550823164584,12.3298604862388,-1.56538839275023,
					3.47307956595774,13.5659831230076,13.4756019246836,5.70302018054192,10.9460163794338,0.454186973880422,-0.804765606511539,
					7.56338473411854,11.9153073145519,14.2953637936495,-2.81100420981550,3.01880257357291,10.3692502969458,1.69217857000088,
					-2.45046266887346,4.08959642516946,11.1697198306638,13.1842510426953,4.62753275122194,-2.39980046172423,21.0458711953170,
					10.1420221847404,1.96218902037604,4.96373637445082,20.0117140690350,-1.16397269654535,8.86072208873976,-2.24941977856366,
					-1.06060006646318,17.1271721592814,18.1274768880650,14.6948246999064,16.2439276299111,12.4668894361549,0.829226021243736,
					6.08987079809971,2.77863863065924,14.0614007743042,2.17077081371261,-2.18582152573579,11.3704352242595,16.3838889413313,
					17.9162031584254,15.5245621777004,12.9271296531870,-0.950943962592346,10.9499826190231,0.782541467995345,17.8669651573803,
					14.6614669088338,-3.03802736922596,-2.21056066336562,3.83983230832677,16.6593261630341,-2.39614433731029,1.17121888802015,
					-1.86991834392409,6.85912928886924,6.12946347134564,-5.65084486038017,12.5635406793157,20.9403674153211,-0.352314648923200,
					16.1300833424943,-4.16436847784666,9.14026530087034,17.5911553529818,0.631435395372210,20.0191958097050,-5.59622630689791,
					-3.05832443350013,14.8031242638906,1.24317041900303,3.39584419911559
			},
			{
					4.93567275849757,13.3846719025246,-1.78916489333844,3.38381006279708,-0.211543339396258,11.7224925387077,7.34984182356510,
					6.10390168631283,17.7569622021699,3.54134821465714,3.70382928372478,6.63930682516824,4.76744596914851,2.91325541033219,
					12.4940132546587,7.88046036170004,8.32743250722452,2.89222864830127,6.26560936167741,5.41048690230530,6.66031213849288,
					-2.15081494377658,6.20872180487566,7.57042739650579,1.45126797558653,14.4122761355692,5.57141590647868,9.35389522229486,
					5.05835925110545,8.95656192564632,0.873006962141510,8.34375928296972,11.3574355584869,11.0268238268433,14.2298042312837,
					6.02710743977813,-3.24489468592066,8.78973902637186,3.19242906527331,4.91672355229154,7.22676791470046,4.41610769620565,
					3.85147007266720,3.39153437814122,2.47229137045105,1.81592114839367,7.33554096118131,0.810941952132634,8.52464049349238,
					2.22037166352616,6.97570987138576,10.7974718454474,7.74455357461908,7.57586281453443,4.07076580297670,9.32881002630877,
					2.53473101535790,7.56852808509879,-0.836078806285618,9.32264855205609,1.55303331949983,1.65063944402456,12.8992094736959,
					7.68849908085581,3.78375221846360,6.90449465875806,0.591547352437339,2.94330395290862,8.31801276796797,11.7804373554191,
					9.55189648666294,-1.23469284766850,12.2798390410256,5.94962795179098,7.95639910437817,1.39760261177494,2.44616028112182,
					5.87848820169614,7.00359124949379,16.7763981358387,1.20247294900262,7.62901706863027,5.94821219005809,4.76489645078402,
					5.76804730161114,6.77551922549645,7.46897494855190,5.54279943593772,9.18410050607547,10.0379073677407,11.4058669917028,
					4.96199347018882,2.52400518126695,4.42945494173763,7.47105013064529,3.11539097213460,5.65341394855929,-1.27783892368662,
					6.01244668673034,11.3065192191298,11.6066753588458,-1.61484222548030,4.57866378421991,4.09661338369554,1.24529969174193,
					-2.87202166312342,2.88486275280186,15.0477282938797,10.7406106455504,7.85085877595961,2.85685280391128,2.67110831186177,
					4.86666748578206,4.81642551811509,7.54147783477798,2.16581329935463,10.2866717812329,13.5409032318556,6.46880876757266,
					8.70431618274664,5.12764756693662,2.68008110642828,2.79073848847969,6.47670982986207,6.51205284457727,1.50294888722290,
					0.990681110690417,6.92358828529989,8.49971809504221,5.89612354410943,3.22509295868633,2.86985751867788,8.21397503701374,
					6.71040784539744,2.70489757356659,4.64104217044397,2.11236073577190,6.55237058495614,5.66219470046300,2.09083589280025,
					4.01520014414510,3.60180328522828,8.82898184503317,4.17364429253973,6.80333570476491,-0.467031278549182,6.67522622718456,
					5.40347594542143,2.55051490409779,6.95596467232156,8.83512880911467,1.90733054643540,8.15166785573791,4.56804014644661,
					4.57576564460847,10.0389691008315,12.2471393526221,5.62159771816111,11.5692300538959,4.17013351999053,12.1597902380492,
					11.4189148283364,6.58774958762957,4.09645503811779,3.31091406467029,5.22899739919282,5.54524312969914,5.89699072673341,
					12.9858862793640,3.70458242205454,3.65174467393044,3.65156566505924,4.72282522787074,12.1157491469266,5.03061301189811,
					19.4204694633265,8.69671357999638,2.70775767267263,1.42875609296331,10.0666409097422,5.83993833958617,5.40983835963796,
					2.96578186721119,6.81166568652527,1.88360371747261,3.36055688025668,1.50651622472535,13.9975157349126,1.41006410785593,
					6.53639290410971,7.43067410255342,8.01970194461521,13.3814679244327,3.41330002454513,13.5678501614751,4.10462510799857,
					4.02247998549592,8.43932912307399,3.21065387677841,5.01159314781474
			}
	};

	double L[200] = {1,0,1,0,1,1,1,0,1,1,1,0,0,1,1,1,1,0,0,1,0,0,0,0,0,0,1,1,1,1,0,1,1,1,0,0,0,1,1,0,1,0,1,0,0,1,1,0,0,1,1,1,1,1,1,
			1,1,1,1,1,1,1,1,1,0,0,1,1,0,0,1,1,0,1,1,0,1,0,0,1,0,0,1,1,0,0,0,0,0,1,0,1,1,1,1,0,1,1,0,0,0,1,1,0,0,0,1,0,0,1,1,1,0,1,
			1,0,1,0,1,1,0,1,1,1,0,1,1,0,0,1,1,1,0,1,1,0,0,1,0,1,0,1,1,0,1,0,1,1,0,0,1,1,0,0,1,0,1,1,0,1,1,1,0,1,0,0,1,0,1,0,0,0,0,
			0,0,0,0,0,0,1,0,0,1,0,0,0,1,1,1,1,0,1,1,0,1,1,0,1,1,1};

	int K = 8;
	int KMI = 10;

	int F_size = 200;

	int p;
	for(p=0; p<200; p++){
		triple* tr = rbf_train(F_size,F,L,K,KMI);

		double* Y = (double *)rbfn_test(F_size,Fs,K,tr);

		int i;
		for(i=0; i<F_size; i++){
			printf("Y[%i] = %lf\n",i,Y[i]);
		}


		free_triple(tr,K);
		free(Y);
	}



	puts("Ended ok");

	return EXIT_SUCCESS;
}
